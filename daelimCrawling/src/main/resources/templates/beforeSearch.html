<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대림통상 제품가격 크롤링</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
          crossorigin="anonymous">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid #dee2e6;
            table-layout: normal;
        }
        th, td {
            border: 1px solid #dee2e6;
            padding: 8px;
            text-align: left;
            word-wrap: break-word;
            white-space: normal; /* Allow text to wrap */
        }
        th {
            background-color: #f8f9fa;
        }
        .table-wrapper {
            max-height: 500px;
            overflow-y: auto;
        }
        .product-name {
            width: 30%;
        }
        .date-column {
            width: 15%;
        }
        .price-column {
            width: 15%;
        }
        .competitor-column {
            width: 15%;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div th:fragment="content" class="container mt-4">
    <div class="logo mb-4">
        <!--<a href="http://localhost:8070/crawling/beforeSearch">
            <img src="/img/logo.JPG" alt="대림통상 로고">
        </a>-->
        <h2>제품가격 모니터링 시스템</h2>
    </div>
    
    <form id="mainForm" action="/crawling/afterSearch" method="get" class="mb-4">
        <div class="form-check form-check-inline">
            <input type="radio" id="allSearch" name="searchType" value="all" class="form-check-input">
            <label for="allSearch" class="form-check-label">전체검색</label>
        </div>
        <div class="form-check form-check-inline">
            <input type="radio" id="naverSearch" name="searchType" value="naver" class="form-check-input">
            <label for="naverSearch" class="form-check-label">네이버쇼핑</label>
        </div>
        <div class="form-check form-check-inline">
            <input type="radio" id="coupangSearch" name="searchType" value="coupang" class="form-check-input">
            <label for="coupangSearch" class="form-check-label">쿠팡</label>
        </div>
      
        <div class="mb-3 mt-3">
            <label for="productCode" class="form-label">쇼핑몰 검색어 입력:</label>
            <input type="text" id="productCode" name="productCode" class="form-control" placeholder="체크박스 검색 안쓸 때 쓰십시오">
        </div>
        <button type="submit" class="btn btn-primary">검색</button>
        <button type="button" class="btn btn-secondary" onclick="clearInput()">지우기</button>
    </form>     

    <form id="searchCheckedForm" action="/crawling/searchChecked" method="post" class="mb-4">
        <div class="table-wrapper">
            <table class="table table-bordered" id="dataTable">
                <thead>
                    <tr>
                        <th scope="col"><input type="checkbox" id="selectAll" onclick="selectAllCheckboxes(this)"></th>
                        <th scope="col">구분</th>
                        <th scope="col">검색대상 제품</th>
                        <th scope="col">허용 최저가격</th>
						<th scope="col">가격 검색범위 &plusmn</th>
                        <th scope="col" colspan="2">경쟁사 제품 1</th>
                        <th scope="col" colspan="2">경쟁사 제품 2</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${list}">
                        <td><input type="checkbox" class="rowCheckbox"></td>
                        <td class="clickable" th:data-slipno="${item.index}" th:data-acdate="${item.index}" th:text="${item.index}">구분</td>
                        <td class="clickable product-name" th:data-slipno="${item.name}" th:data-acdate="${item.name}" th:text="${item.name}">검색대상 제품</td>
                        <td class="clickable" th:data-slipno="${item.price}" th:data-acdate="${item.price}" th:text="${item.price}">최저가격 설정</td>
						<td class="clickable" th:data-slipno="${item.searchLimit}" th:data-acdate="${item.searchLimit}" th:text="${item.searchLimit}">가격 검색범위 &plusmn</td>
						<td class="clickable competitor-column" th:data-slipno="${item.competitor1Product}" th:data-acdate="${item.competitor1Product}" th:text="${item.competitor1Product}">경쟁사 제품 1</td>
                        <td class="clickable competitor-column" th:data-slipno="${item.competitor1Name}" th:data-acdate="${item.competitor1Name}" th:text="${item.competitor1Name}">경쟁사1 이름</td>
                        <td class="clickable competitor-column" th:data-slipno="${item.competitor2Product}" th:data-acdate="${item.competitor2Product}" th:text="${item.competitor2Product}">경쟁사 제품 2</td>
                        <td class="clickable competitor-column" th:data-slipno="${item.competitor2Name}" th:data-acdate="${item.competitor2Name}" th:text="${item.competitor2Name}">경쟁사2 이름</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="mt-3">
            <button type="button" class="btn btn-success" onclick="addRow()">데이터 추가</button>
            <button type="button" class="btn btn-danger" onclick="deleteRow()">데이터 삭제</button>
            <button type="button" class="btn btn-info" onclick="searchChecked()">선택항목 검색</button>
        </div>

        <div class="form-check form-switch mt-3">
            <input class="form-check-input" type="checkbox" id="autoSearchToggle">
            <label class="form-check-label" for="autoSearchToggle">실시간 자동감시 활성화</label>
        </div>
        <div class="mt-2">
            <label for="autoSearchInterval" class="form-label">자동감시 주기:</label>
            <select id="autoSearchInterval" class="form-select w-auto">
                <option value="1">하루</option>
                <option value="3">3일</option>
                <option value="5">5일</option>
                <option value="7">7일</option>
                <option value="15">15일</option>
            </select>
        </div>

        <!-- 과거 검색기록 섹션 시작 -->
        <div class="mt-4">
            <h3>과거기록 조회</h3>
            <div class="mb-3">
                <label for="searchDate" class="form-label">날짜 선택:</label>
                <input type="date" id="searchDate" name="searchDate" class="form-control w-auto d-inline">
				<!-- 검색 버튼에 onclick 이벤트 추가 -->
				<button type="button" class="btn btn-primary ms-3" onclick="searchPast()">해당날짜 검색</button>
                <label for="pastSearchKeyword" class="form-label ms-3">조회결과 검색필터</label>
                <input type="text" id="pastSearchKeyword" name="pastSearchKeyword" class="form-control w-auto d-inline">
				<button type="button" class="btn btn-primary ms-3" onclick="filterData()">검색필터 적용</button>
            </div>
            <div class="table-wrapper">
                <table class="table table-bordered" id="pastDataTable">
                    <thead>
                        <tr>
                            <th scope="col" class="date-column">날짜</th>
                            <th scope="col" class="product-name">제품이름</th>
                            <th scope="col" class="price-column">가격</th>
                            <th scope="col" class="link-column">링크</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 여기에 검색 결과가 표시됩니다 -->
                    </tbody>
                </table>
            </div>
        </div>
        <!-- 과거 검색기록 섹션 끝 -->
    </form>
</div>
</body>
</html>
